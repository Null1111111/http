# HTTP

**HTTP** (*Hypertext Transfer Protocol*) — это протокол прикладного уровня, изначально предназначавшийся для передачи гипертекста. Сегодня основная его задача — обеспечить обмен документами в сети Интернет, включая HTML-страницы, изображения, видео и другие ресурсы. HTTP следует модели клиент-сервер, где клиент делает запросы, а сервер отправляет ответы.

Протокол был разработан с учётом простоты и совместимости, что позволило ему стать стандартом для веб-приложений и онлайн-сервисов.

## Программное обеспечение

Для работы с HTTP используется три типа программного обеспечения:

- **Клиенты**:
  Это программы, которые посылают HTTP-запросы к серверам. Основные типы клиентов:
    - **Браузеры**: К примеру Google Chrome, Mozilla Firefox, Microsoft Edge. Они обрабатывают и визуализируют полученные от серверов документы (HTML, CSS, JavaScript).
    - **Командные инструменты**: такие как `curl` или `wget`, которые позволяют отправлять HTTP-запросы с командной строки.
    - **Мобильные и настольные приложения**: приложения, использующие HTTP для взаимодействия с серверами, например почтовые клиенты, социальные сети и т.д.

- **Веб-серверы**:
  Они принимают и обрабатывают HTTP-запросы от клиентов, возвращая соответствующие ответы. Наиболее популярные веб-серверы: Apache HTTP Server, Nginx, Microsoft IIS, LiteSpeed, Google Web Server, lighttpd.

- **Прокси-серверы**:
  Прокси-серверы действуют как посредники между клиентом и сервером, фильтруя, изменяя или кэшируя запросы. Основные примеры: Squid, HAProxy, Varnish


## Структура HTTP-сообщения

HTTP-сообщение передаёт данные в формате «запрос-ответ» и имеет следующую структуру:

1. **Стартовая строка**:
    - В запросах она содержит метод запроса, URL и версию протокола, например: ``` GET /index.html HTTP/1.1 ```
    - В ответах стартовая строка содержит версию протокола, код статуса и описание: ``` HTTP/1.1 200 OK ```
2. **Заголовки**:
    - Заголовки содержат метаданные о запросе или ответе. Примеры заголовков:
        - `Host`: доменное имя сервера.
        - `User-Agent`: информация о клиенте, отправляющем запрос.
        - `Content-Type`: тип передаваемых данных.
        - `Accept`: указывает, какие типы данных клиент может принять.

3. **Тело сообщения**:
    - Эта часть необязательна и присутствует, если передаются данные. В запросах тело может содержать данные формы или файлы, а в ответах — контент, такой как HTML-документ, JSON-ответ или бинарные файлы.

        Пример диалога запрос-ответ с заголовками и телом сообщения:
        ``` 
        GET /api/v1/users?status=active HTTP/1.1
        Host: api.example.com
        User-Agent: curl/7.68.0
        Accept: application/json 
        ```
        ``` 
        HTTP/1.1 200 OK
        Content-Type: application/json
        Content-Length: 342
        
        [
            {"id": 1, "name": "John Doe", "status": "active"},
            {"id": 2, "name": "Jane Smith", "status": "active"}
        ]
        ```

## Методы

HTTP предлагает несколько методов, которые определяют тип взаимодействия клиента с ресурсами:

- **GET**: Запрашивает данные с сервера. Это наиболее часто используемый метод для получения информации. Данные передаются через URL, что ограничивает объём информации, которую можно передать.
  
- **POST**: Отправляет данные на сервер для создания нового ресурса. В отличие от GET, данные передаются в теле запроса.
Пример: Создание новой записи пользователя.
    ```
    POST /users HTTP/1.1
    Content-Type: application/json
    
    {
        "name": "New User",
        "email": "user@example.com"
    }
    ```
- **PUT**: Полностью обновляет ресурс на сервере. Все данные ресурса передаются в запросе, и старые данные заменяются новыми (предполагает идемпотентность).
Пример: Обновление информации о пользователе.
    ```
    PUT /users/1 HTTP/1.1
    Content-Type: application/json
    
    {
        "name": "Joe",
        "status": "inactive"
    }
    ```
- **PATCH**: Обновляет только часть ресурса. В отличие от PUT, PATCH передаёт только изменённые поля.
Пример: Обновление статуса пользователя.
    ```
    PATCH /users/1 HTTP/1.1
    Content-Type: application/json
    
    {
        "status": "active"
    }
    ```
- **DELETE**: Удаляет ресурс с сервера.
Пример: Удаление пользователя.
    ```
    DELETE /users/1 HTTP/1.1
    ```
- **OPTIONS**: Возвращает информацию о поддерживаемых методах для указанного ресурса.

- **HEAD**: Аналогичен GET, но возвращает только заголовки ответа, без тела. Используется для проверки существования ресурса или его характеристик.

- **TRACE**: Возвращает полный маршрут запроса, что помогает в диагностике сетевых проблем.

- **CONNECT**: Используется для создания туннеля, например, для установления защищённого соединения через прокси (обычно для HTTPS).

## Коды состояния

Коды состояния сигнализируют клиенту о результате обработки запроса.

- **1xx (Информационные)**: Указывают на то, что запрос получен и обработка продолжается, например: `100 Continue`- Cервер удовлетворён начальными сведениями о запросе.
  
- **2xx (Успешные)**: Запрос был успешно выполнен, например: `200 OK`- Запрос успешно выполнен, `201 Created` - Ресурс успешно создан.

- **3xx (Перенаправления)**: Указывают на необходимость дальнейших действий со стороны клиента, например: `301 Moved Permanently`- Ресурс перемещён на другой URL, `302 Found` - Временная переадресация.

- **4xx (Ошибки клиента)**: Указывают на ошибку в запросе со стороны клиента, например: `400 Bad Request`- Некорректный запрос, `404 Not Found` - Ресурс не найден.

- **5xx (Ошибки сервера)**: Указывают на проблему на стороне сервера, например: `500 Internal Server Error`- Внутренняя ошибка сервера, `502 Bad Gateway` - Ошибка на уровне промежуточного сервера.

## Основные механизмы HTTP

- **Кэширование**: Кэширование позволяет уменьшить нагрузку на сервер и сократить время загрузки для клиента. Заголовки `Cache-Control`, `Expires` и `ETag` определяют, как долго и где хранить кэшированную версию ресурса.

- **Сжатие**: HTTP поддерживает сжатие данных перед отправкой. Сжатие может выполняться на уровне заголовков или тела сообщения, например, с использованием `Content-Encoding: gzip`.

- **Поддержка сессий**: HTTP не сохраняет состояние, но сессии могут быть реализованы с помощью cookies и заголовков `Set-Cookie`. Это позволяет сохранять информацию о пользователе между запросами (например, идентификатор сессии).

- **Поддержка различных форматов данных**: HTTP может передавать различные типы данных — от простого текста до изображений и видео, что определяется заголовком `Content-Type`. Например:
    - `text/html` — для HTML страниц,
    - `application/json` — для данных в формате JSON,
    - `image/png` — для изображений.

- **Шифрование**: HTTP использует TLS (HTTPS) для шифрования передаваемых данных, что защищает их от перехвата.

## Развитие и актуальность

HTTP был создан в 1991 году Тимом Бернерсом-Ли. Первая версия — **HTTP/0.9** — была крайне простой и поддерживала только передачу HTML-страниц. С выходом **HTTP/1.0** в 1996 году протокол получил поддержку заголовков, статусов и методов. В 1999 году появился **HTTP/1.1**, основное его отличие — поддержка постоянных соединений, на протяжении долгого времени эта версия имела наиболее широкое применение.

Сегодня около 60-70% всех веб-сайтов используют **HTTP/2**, который был представлен в 2015 году, его популярность постепенно возросла благодаря улучшенным возможностям производительности и поддержке большинства современных браузеров. В 2020 году начал применяться **HTTP/3**, который основан на QUIC, снижая задержки и улучшая производительность в условиях нестабильных сетей. Он активно внедряется и уже обслуживает около 10-15% мирового трафика.

Также по состоянию на 2024 год более 90% всех сайтов используют **HTTPS**. Это безопасная версия HTTP, которая использует SSL/TLS для шифрования данных.

HTTP остаётся универсальным выбором для большинства веб-приложений благодаря своей гибкости и широкому распространению.

Источники: [Wikipedia](https://ru.wikipedia.org/wiki/HTTP), [MDN Web Docs](https://developer.mozilla.org/ru/docs/Web/HTTP/Overview), [W3Techs](https://w3techs.com/)
